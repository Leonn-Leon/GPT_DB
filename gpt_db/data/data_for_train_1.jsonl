{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи список фактур"}, {"role": "assistant", "content": "select distinct VBRK_VBELN from ZSDM_117 where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи фактуры"}, {"role": "assistant", "content": "select distinct VBRK_VBELN from ZSDM_117 where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи фактуры и позиции"}, {"role": "assistant", "content": "select VBRK_VBELN, VBRP_POSNR from ZSDM_117 where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи общую маржинальную прибыль"}, {"role": "assistant", "content": "select sum(ZAMARGPRF) from ZSDM_117 where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи фактуры и количество позиций"}, {"role": "assistant", "content": "SELECT VBRK_VBELN, COUNT(VBRP_POSNR) AS Positions_Count FROM ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') GROUP BY VBRK_VBELN"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи список клиентов"}, {"role": "assistant", "content": "SELECT DISTINCT ZCUSTOMER FROM ZZSDM_117_CUST WHERE VBRK_FKDAT = TO_VARCHAR(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи топ 5 самых дорогих позиций"}, {"role": "assistant", "content": "SELECT TOP 5 VBRK_VBELN, VBRP_POSNR, ZAREVENF_RUB FROM ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') ORDER BY ZAREVENF_RUB DESC"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи среднюю маржу по позициям"}, {"role": "assistant", "content": "SELECT AVG(ZAMARGPRF_RUB) AS Avg_Margin FROM ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи среднюю маржу по фактурам"}, {"role": "assistant", "content": "SELECT AVG(ZAMARGPRF_RUB) AS Avg_Margin FROM (select sum(ZAMARGPRF_RUB) from ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by VBRK_VBELN) as t"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи среднюю маржу по отгрузкам"}, {"role": "assistant", "content": "SELECT AVG(ZAMARGPRF_RUB) AS Avg_Margin FROM (select sum(ZAMARGPRF_RUB) from ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by VBRK_VBELN) as t"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи маржу по отгрузкам"}, {"role": "assistant", "content": "SELECT VBRK_VBELN, sum(ZAMARGPRF_RUB) AS Avg_Margin FROM ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by VBRK_VBELN"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи отгруженные материалы и их количества в кг"}, {"role": "assistant", "content": "SELECT VBRP_MATNR, sum(FKIMG_KG) FROM ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by VBRP_MATNR"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи сумму выручки по каждому каналу сбыта"}, {"role": "assistant", "content": "SELECT VBRK_VTWEG, SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') GROUP BY VBRK_VTWEG"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи отгрузку с большим количество позиций"}, {"role": "assistant", "content": "SELECT TOP 1 VBRK_VBELN, count(VBRP_POSNR) FROM ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by VBRK_VBELN ORDER BY count(VBRP_POSNR) DESC"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи топ 3 менеджера по количеству отгрузок"}, {"role": "assistant", "content": "SELECT TOP 3 VBRK_ZZPERNR_ZM, count(distinct VBRK_VBELN) from ZZSDM_117_CUST where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by VBRK_ZZPERNR_ZM order by count(distinct VBRK_VBELN) desc"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи количество клиентов в уральском дивизионе"}, {"role": "assistant", "content": "select count(distinct ZCUSTOMER) from ZZSDM_117_CUST where ZDIV = '02' and VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи количество отгрузок в сибирском дивизионе"}, {"role": "assistant", "content": "select count(distinct VBRK_VBELN) from ZZSDM_117_CUST where ZDIV = '04' and VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи отгрузку с максимальной маржинальной прибылью в поволжском дивизионе"}, {"role": "assistant", "content": "select TOP 1 VBRK_VBELN, sum(ZAMARGPRF) from ZSDM_117 where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by VBRK_VBELN order by sum(ZAMARGPRF) desc"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку в уральском и сибирском дивизионе"}, {"role": "assistant", "content": "select ZDIV, sum(ZAREVENF_RUB) from ZZSDM_117_CUST where ZDIV in ('02', '04') and VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by ZDIV"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Выведи фактуры за 2024 год"}, {"role": "assistant", "content": "SELECT count(distinct VBRK_VBELN) FROM ZZSDM_117_CUST WHERE left(VBRK_FKDAT, 4) = '2024'"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи позиции, отгруженные за последнюю неделю"}, {"role": "assistant", "content": "SELECT VBRK_VBELN, VBRP_POSNR FROM ZZSDM_117_CUST WHERE VBRK_FKDAT >= to_varchar(add_days(CURRENT_DATE, -7), 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "В каком месяце 2023 года была самая высокая выручка?"}, {"role": "assistant", "content": "SELECT TOP 1 left(VBRK_FKDAT, 6) AS Month, SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE left(VBRK_FKDAT, 4) = '2023' GROUP BY left(VBRK_FKDAT, 6) ORDER BY SUM(ZAREVENF_RUB) DESC"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Сколько клиентов отгрузилось в январе?"}, {"role": "assistant", "content": "SELECT count(distinct ZCUSTOMER) FROM ZZSDM_117_CUST WHERE left(VBRK_FKDAT, 6) = to_varchar(CURRENT_DATE, 'YYYY') || '01'"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи распределение выручки по кварталам за 2024 год"}, {"role": "assistant", "content": "select QUARTER(VBRK_FKDAT), sum(ZAREVENF_RUB) from ZZSDM_117_CUST where left(VBRK_FKDAT, 4) = '2024' group by quarter(VBRK_FKDAT)"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку за период января 2023 года по май 2024 года"}, {"role": "assistant", "content": "SELECT SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE left(VBRK_FKDAT, 6) BETWEEN '202301' AND '202305'"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку за второе мая"}, {"role": "assistant", "content": "SELECT SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYY') || '0502'"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку за вчера"}, {"role": "assistant", "content": "SELECT SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE VBRK_FKDAT = to_varchar(add_days(CURRENT_DATE, -1), 'YYYYMMDD')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку за первый квартал"}, {"role": "assistant", "content": "SELECT SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE QUARTER(VBRK_FKDAT) = to_varchar(CURRENT_DATE, 'YYYY') || '-Q1'"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку за второй квартал"}, {"role": "assistant", "content": "SELECT SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE QUARTER(VBRK_FKDAT) = to_varchar(CURRENT_DATE, 'YYYY') || '-Q2'"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку за текущий квартал"}, {"role": "assistant", "content": "SELECT SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE QUARTER(VBRK_FKDAT) = QUARTER(CURRENT_DATE)"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку с первого по пятое марта"}, {"role": "assistant", "content": "SELECT SUM(ZAREVENF_RUB) FROM ZZSDM_117_CUST WHERE VBRK_FKDAT BETWEEN to_varchar(CURRENT_DATE, 'YYYY') || '0301' AND to_varchar(CURRENT_DATE, 'YYYY') || '0305'"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи маржу за текущий месяц по филиалам с кодам 01 и 02"}, {"role": "assistant", "content": "select ZCFO1, sum(ZAMARGPRF) from ZSDM_117 where ZCFO in ('01', '02') and left(VBRK_FKDAT, 6) = to_varchar(CURRENT_DATE, 'YYYYMM') group by ZCFO1"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи маржу за месяц по филиалам с кодами 01 и 02"}, {"role": "assistant", "content": "select ZCFO1, sum(ZAMARGPRF) from ZSDM_117 where ZCFO in ('01', '02') and left(VBRK_FKDAT, 6) = to_varchar(CURRENT_DATE, 'YYYYMM') group by ZCFO1"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи маржу за прошлый год"}, {"role": "assistant", "content": "select sum(ZAMARGPRF) from ZSDM_117 where left(VBRK_FKDAT, 4) = to_varchar(add_year(CURRENT_DATE, -1), 'YYYY')"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи отгрузки с максимальной маржинальной прибылью за прошлый месяц"}, {"role": "assistant", "content": "select VBRK_VBELN, sum(ZAMARGPRF) from ZSDM_117 where left(VBRK_FKDAT, 6) = to_varchar(add_months(CURRENT_DATE, -1), 'YYYYMM') group by VBRK_VBELN"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи отгрузки с максимальным количеством позиций в первом месяце этого года"}, {"role": "assistant", "content": "select TOP 1 VBRK_VBELN, count(VBRP_POSNR) from ZSDM_117 where left(VBRK_FKDAT, 6) = to_varchar(CURRENT_DATE, 'YYYY') || '01' group by VBRK_VBELN order by count(VBRP_POSNR) desc"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи позицию с самой низкой выручкой за этот месяц"}, {"role": "assistant", "content": "select TOP 1 VBRP_POSNR, ZAREVENF from ZSDM_117 where left(VBRK_FKDAT, 6) = to_varchar(CURRENT_DATE, 'YYYYMM') order by count(VBRP_POSNR) asc"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи отгрузку с самой низкой выручкой за этот месяц"}, {"role": "assistant", "content": "select TOP 1 VBRK_VBELN, sum(ZAREVENF) from ZSDM_117 where left(VBRK_FKDAT, 6) = to_varchar(CURRENT_DATE, 'YYYYMM') group by VBRK_VBELN order by sum(ZAREVENF) desc"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи выручку и количество фактур за сегодня по всем дивизионам"}, {"role": "assistant", "content": "select zdiv, sum(ZAREVENF), count(distinct VBRK_VBELN) from ZSDM_117 where VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by zdiv"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи АГ2 с самой низкой маржинальной прибылью"}, {"role": "assistant", "content": "select ZPRODH21, sum(ZAMARGPRF), count(distinct VBRK_VBELN) from ZSDM_117 where zdiv = '100' VBRK_FKDAT = to_varchar(CURRENT_DATE, 'YYYYMMDD') group by ZPRODH21 order by sum(ZAMARGPRF) asc"}]}
{"messages": [{"role": "system", "content": "Ты эксперт в SQL и аналитике данных. Твоя задача генерировать SQL код для SAP HANA"}, {"role": "user", "content": "Покажи АГ2 с самой низкой маржинальной прибылью в этом месяце"}, {"role": "assistant", "content": "select ZPRODH21, sum(ZAMARGPRF), count(distinct VBRK_VBELN) from ZSDM_117 where zdiv = '100' left(VBRK_FKDAT, 6) = to_varchar(CURRENT_DATE, 'YYYYMM') group by ZPRODH21 order by sum(ZAMARGPRF) asc"}]}
